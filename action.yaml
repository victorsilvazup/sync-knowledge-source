name: "Sync Knowledge Source"
description: "Sincroniza arquivos locais com um Knowledge Source na StackSpot"
inputs:
  ks_slug:
    description: "Slug do Knowledge Source"
    required: true
  files_dir:
    description: "Diretório com os arquivos a serem sincronizados"
    required: true
  client_id:
    description: "Client ID para autenticação"
    required: true
  client_secret:
    description: "Client Secret para autenticação"
    required: true
  realm:
    description: "Realm usado no login"
    required: true
runs:
  using: "composite"
  steps:
    - name: Setup Python
      uses: actions/setup-python@v4
      with:
        python-version: '3.x'

    - name: Install dependencies
      shell: bash
      run: pip install requests

    - name: Run sync script
      shell: bash
      run: |
        export KS_SLUG=${{ inputs.ks_slug }}
        export FILES_DIR=${{ inputs.files_dir }}
        export CLIENT_ID=${{ inputs.client_id }}
        export CLIENT_SECRET=${{ inputs.client_secret }}
        export REALM=${{ inputs.realm }}
        python3 ${{ github.action_path }}/sync_ks.py